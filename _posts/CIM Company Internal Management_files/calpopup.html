<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0034)http://crm.apexnet.it/calpopup.htm -->
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=windows-1252"><title>Scegli una data</title>


<style type="text/css">
.CalHeader 
{
	FONT-WEIGHT: bold; FONT-SIZE: 11px; BACKGROUND: #99C2EB; COLOR: #0E4D79; FONT-STYLE: normal; FONT-FAMILY: Tahoma,Sans-serif;
	position: absolute; left:24px ; top:5px; width:109px; height: 17px; text-align:center;
}
.CalHeaderArrowSX
{
	BACKGROUND: #99C2EB; CURSOR: pointer; COLOR: white;
	position: absolute; left:5px ; top:5px;
}
.CalHeaderArrowDX 
{
	BACKGROUND: #99C2EB; cursor: pointer; COLOR: white;
	position: absolute; left:133px ; top:5px;
}
.CalHeaderWeek
{
	position:absolute; left:5px ; top:23px;
	background-color: #ebf1f1;
	width: 147px;
	height: 19px;
}
.CloseLink 
{
	FONT-WEIGHT: bold; FONT-SIZE: 11px; COLOR: white; FONT-FAMILY: Tahoma,Sans-serif; height: 10px; width:147px;
	position:absolute; left:5px ; top:140px;  width: 63px; height: 18px; text-align:center;
	margin-left: 42px; cursor: pointer; padding-top: 2px;
	background-image: url(calimages/close.gif); background-repeat: no-repeat;
}
.hrdata 
{
	position: absolute;
	top: 3px;
	width: 21px;
  height: 16px;
	font-weight: normal;
  font-size: 11px;
  font-family: Tahoma,Sans-serif;
	text-align: center;
  color: #404040;
}
.nodata 
{
	WIDTH: 21px; POSITION: absolute; HEIGHT: 16px; VERTICAL-ALIGN:middle;
}
.sidata 
{
	WIDTH: 21px; CURSOR: pointer; POSITION: absolute; HEIGHT: 16px;
	FONT-WEIGHT: normal; FONT-SIZE: 11px; FONT-FAMILY: Tahoma,Sans-serif;
	TEXT-ALIGN: center; COLOR: #404040;
}
.wedata 
{
	WIDTH: 21px; CURSOR: pointer; POSITION: absolute; HEIGHT: 16px;
	FONT-WEIGHT: normal; FONT-SIZE: 11px; FONT-FAMILY: Tahoma,Sans-serif;
	TEXT-ALIGN: center; COLOR: #404040; BACKGROUND-COLOR: #EBEAD8;
}
.wndata 
{
	WIDTH: 21px; POSITION: absolute; HEIGHT: 16px;BACKGROUND-COLOR: #EBEAD8;
}
.seldata 
{
	WIDTH: 21px; POSITION: absolute; HEIGHT: 16px
}
</style>
<style type="text/css"></style></head>

<body style="background-image:url(calimages/background.gif)" onload="LoadCalendar()" marginwidth="0" marginheight="0">
<div class="CalHeaderArrowSX" id="PrevDiv"><img id="Prev" onclick="PrevMonth();" height="17px" src="prev.gif" width="19px" alt=""></div>
<div class="CalHeader"><span id="MonthTitle"></span>&nbsp;<span id="YearTitle"></span></div>
<div class="CalHeaderArrowDX" id="NextDiv"><img id="Next" onclick="NextMonth();" height="17px" src="next.gif" width="19px" alt=""></div>
<div class="CalHeaderWeek" id="WeekHdr"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></div>
<div id="CalDateContainerFront" style="Z-INDEX: 25; VISIBILITY: visible; POSITION: absolute;"><span day="1" class="sidata" style="left: 6px; top: 43px; width: 21px; height: 16px;"></span><span day="2" class="sidata" style="left: 27px; top: 43px; width: 21px; height: 16px;"></span><span day="3" class="sidata" style="left: 48px; top: 43px; width: 21px; height: 16px;"></span><span day="4" class="sidata" style="left: 69px; top: 43px; width: 21px; height: 16px;"></span><span day="5" class="sidata" style="left: 90px; top: 43px; width: 21px; height: 16px;"></span><span day="6" class="sidata" style="left: 111px; top: 43px; width: 21px; height: 16px;"></span><span day="7" class="sidata" style="left: 132px; top: 43px; width: 21px; height: 16px;"></span><span day="8" class="sidata" style="left: 6px; top: 59px; width: 21px; height: 16px;"></span><span day="9" class="sidata" style="left: 27px; top: 59px; width: 21px; height: 16px;"></span><span day="10" class="sidata" style="left: 48px; top: 59px; width: 21px; height: 16px;"></span><span day="11" class="sidata" style="left: 69px; top: 59px; width: 21px; height: 16px;"></span><span day="12" class="sidata" style="left: 90px; top: 59px; width: 21px; height: 16px;"></span><span day="13" class="sidata" style="left: 111px; top: 59px; width: 21px; height: 16px;"></span><span day="14" class="sidata" style="left: 132px; top: 59px; width: 21px; height: 16px;"></span><span day="15" class="sidata" style="left: 6px; top: 75px; width: 21px; height: 16px;"></span><span day="16" class="sidata" style="left: 27px; top: 75px; width: 21px; height: 16px;"></span><span day="17" class="sidata" style="left: 48px; top: 75px; width: 21px; height: 16px;"></span><span day="18" class="sidata" style="left: 69px; top: 75px; width: 21px; height: 16px;"></span><span day="19" class="sidata" style="left: 90px; top: 75px; width: 21px; height: 16px;"></span><span day="20" class="sidata" style="left: 111px; top: 75px; width: 21px; height: 16px;"></span><span day="21" class="sidata" style="left: 132px; top: 75px; width: 21px; height: 16px;"></span><span day="22" class="sidata" style="left: 6px; top: 91px; width: 21px; height: 16px;"></span><span day="23" class="sidata" style="left: 27px; top: 91px; width: 21px; height: 16px;"></span><span day="24" class="sidata" style="left: 48px; top: 91px; width: 21px; height: 16px;"></span><span day="25" class="sidata" style="left: 69px; top: 91px; width: 21px; height: 16px;"></span><span day="26" class="sidata" style="left: 90px; top: 91px; width: 21px; height: 16px;"></span><span day="27" class="sidata" style="left: 111px; top: 91px; width: 21px; height: 16px;"></span><span day="28" class="sidata" style="left: 132px; top: 91px; width: 21px; height: 16px;"></span><span day="29" class="sidata" style="left: 6px; top: 107px; width: 21px; height: 16px;"></span><span day="30" class="sidata" style="left: 27px; top: 107px; width: 21px; height: 16px;"></span><span day="31" class="sidata" style="left: 48px; top: 107px; width: 21px; height: 16px;"></span><span day="32" class="sidata" style="left: 69px; top: 107px; width: 21px; height: 16px;"></span><span day="33" class="sidata" style="left: 90px; top: 107px; width: 21px; height: 16px;"></span><span day="34" class="sidata" style="left: 111px; top: 107px; width: 21px; height: 16px;"></span><span day="35" class="sidata" style="left: 132px; top: 107px; width: 21px; height: 16px;"></span><span day="36" class="sidata" style="left: 6px; top: 123px; width: 21px; height: 16px;"></span><span day="37" class="sidata" style="left: 27px; top: 123px; width: 21px; height: 16px;"></span><span day="38" class="sidata" style="left: 48px; top: 123px; width: 21px; height: 16px;"></span><span day="39" class="sidata" style="left: 69px; top: 123px; width: 21px; height: 16px;"></span><span day="40" class="sidata" style="left: 90px; top: 123px; width: 21px; height: 16px;"></span><span day="41" class="sidata" style="left: 111px; top: 123px; width: 21px; height: 16px;"></span><span day="42" class="sidata" style="left: 132px; top: 123px; width: 21px; height: 16px;"></span></div>
<img id="MonthImg" style="Z-INDEX: 20; LEFT: 5px; VISIBILITY: visible; POSITION: relative; TOP: 42px" height="96px" alt="" src="blank.gif" width="147px"><br>
<img class="seldata" id="SelDate" onclick="javascript:CloseCalendar()" style="DISPLAY:none;Z-INDEX:40;cursor:pointer" height="16px" alt="" src="seldt.gif" width="21px">
<div id="CloseButton" class="CloseLink" onclick="javascript:CloseCalendar()">Chiudi</div>

<script type="text/javascript" language="javascript">
var glbLoaded  = false;
var DaysSpan   = document.getElementById("CalDateContainerFront").childNodes;
var MainWindow = window.parent;
var CalFrame   = MainWindow.document.getElementById("calpopup");

var ImgWidth   = 21;
var ImgHeight  = 16;

var glbAttDay = -1;
var glbAttMonth = -1;
var glbAttYear = -1;

var glbInputDay = -1;
var glbInputMonth = -1;
var glbInputYear = -1;

function LoadCalendar() 
{
	var browser = window.event ? 1 : 2; //1=IE; 2=altri
	for(i = 0; i<7; i++) 
	{
		for(j = 0; j<6; j++) 
		{
			var idx = (j*7)+i;
			var sp = DaysSpan[idx];
			if (browser==1)
				sp.onclick = new Function ("onclick", "ClickData(event)");
			else
				sp.setAttribute("onclick", "ClickData(event)");
			sp.setAttribute("day", idx+1);
			sp.className = "sidata";
			sp.style.left = (parseInt(document.getElementById("MonthImg").style.left) + 2 + (ImgWidth*i) - 1)+"px";
			sp.style.top = (parseInt(document.getElementById("MonthImg").style.top) + 1 + (ImgHeight*j))+"px";
			sp.style.width = ImgWidth+"px";
			sp.style.height = ImgHeight+"px";			
		}
	}
}

function ClickData(evento) 
{
	var trg = (evento.srcElement)?evento.srcElement:evento.target;
	if(trg.className == "sidata" || trg.className == "wedata") 
	{
		var WhichDay = trg.getAttribute("day");
		WhichDay -= GetDayOfWeek(1, glbAttMonth, glbAttYear);
		MainWindow.SetDate(WhichDay, glbAttMonth, glbAttYear);
		CalFrame.style.display = "none";
	}	
	evento.cancelBubble = true;
}

function NextMonth() 
{
	if(glbAttMonth == 12) 
		SetDate(glbAttDay, 1, glbAttYear+1);
	else
		SetDate(glbAttDay, glbAttMonth+1, glbAttYear);
}

function PrevMonth() 
{
	if(glbAttMonth == 1)
		SetDate(glbAttDay, 12, glbAttYear-1);
	else
		SetDate(glbAttDay, glbAttMonth-1, glbAttYear);
}

function CloseCalendar() 
{
	CalFrame.style.display = "none";
	MainWindow.SetDate(0, 0, 0);
}


function SetInputDate(intDate,intMonth,intYear) 
{
	glbInputDay = intDate;
	glbInputMonth = intMonth;
	glbInputYear = intYear;
}


function SetDate(vDay, vMonth, vYear) 
{
	var TipoVis = "none";
	var idx;

	if( (glbInputDay != -1) && (vMonth == glbInputMonth) && (vYear == glbInputYear) )	
	{
		// Calcolo indice span per data selezionata
		idx = glbInputDay + GetDayOfWeek(1, glbInputMonth, glbInputYear) - 1;
		document.getElementById("SelDate").style.left = (parseInt(DaysSpan[idx].style.left) - 1)+"px";
		document.getElementById("SelDate").style.top = (parseInt(DaysSpan[idx].style.top) - 1)+"px";
		TipoVis = "block";
	}
	document.getElementById("SelDate").style.display = TipoVis;
	//
	var i = 0;
	var iMin = GetDayOfWeek(1, vMonth, vYear);
	var iMax = MainWindow.DaysInMonth(vMonth, vYear) + GetDayOfWeek(1, vMonth, vYear);
	//
	for(i; i<iMin; i++) 
	{
		if (i%7>=5)
			DaysSpan[i].className = "wndata";
		else
			DaysSpan[i].className = "nodata";
		DaysSpan[i].innerHTML = "";
	}
	//
	for(i; i<iMax; i++) 
	{
		DaysSpan[i].innerHTML = String(i-iMin+1);
		if (i%7>=5)
			DaysSpan[i].className = "wedata";
		else
			DaysSpan[i].className = "sidata";
	}
	//
	for(i; i<42; i++) 
	{
		if (i%7>=5)
			DaysSpan[i].className = "wndata";
		else
			DaysSpan[i].className = "nodata";
		DaysSpan[i].innerHTML = "";
	}
	document.getElementById("MonthTitle").innerHTML = MainWindow.GetNameOfMonth(vMonth);
	document.getElementById("YearTitle").innerHTML = String(vYear.toString());
	document.getElementById("CloseButton").innerHTML = MainWindow.CloseCaption;
  var WeekHdrObj =	document.getElementById("WeekHdr");
	for (var i=0; i<WeekHdrObj.childNodes.length; i++)
	{
	  var WeekHdrDObj = WeekHdrObj.childNodes[i];
  	WeekHdrDObj.innerHTML = MainWindow.DayNames[i];
  	WeekHdrDObj.className = "hrdata";
  	WeekHdrDObj.style.left = (i*21 + 1) + "px";
  }
	//
	glbAttDay = vDay;
	glbAttMonth = vMonth;
	glbAttYear = vYear;
}

function GetDayOfWeek(vDay, vMonth, vYear) 
{
	var d = new Date(vYear, vMonth-1, vDay);
	var g = d.getDay() % 7;
	if (g==0)
		g=6;
	else
		g--;
	return(g);
}
</script>

<script type="text/javascript" language="javascript">
glbLoaded = true;
</script>


</body></html>